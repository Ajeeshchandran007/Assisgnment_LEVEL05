The cache for model files in Transformers v4.22.0 has been updated. Migrating your old cache. This is a one-time only operation. You can interrupt this and resume the migration later on by calling `transformers.utils.move_cache()`.
â€‡0/0â€‡[00:00<?,â€‡?it/s]
======================================================================
ðŸŽ¬ LLAMA 3.2 QLORA FINE-TUNING
   Sentiment Classification with 4-bit Quantization
   FIXED VERSION - Enhanced Stability
======================================================================
ðŸ“Š Dataset: 60 samples
   âœ… Positive: 20
   âŒ Negative: 20
   âšª Neutral:  20
======================================================================

======================================================================
ðŸ” SYSTEM CHECK
======================================================================
âœ… GPU Available: Tesla T4
âœ… Total GPU Memory: 15.83 GB
âœ… CUDA Version: 12.6
âœ… PyTorch Version: 2.9.0+cu126
âœ… GPU cache cleared
======================================================================

ðŸ“¦ Loading model with QLoRA (4-bit quantization)...
   Tokenizer loaded: PreTrainedTokenizerFast
   Vocab size: 128256
   PAD token: <|end_of_text|> (ID: 128001)
   EOS token: <|end_of_text|> (ID: 128001)
   Loading base model (this may take 2-3 minutes)...
config.json:â€‡100%
â€‡843/843â€‡[00:00<00:00,â€‡102kB/s]
model.safetensors:â€‡100%
â€‡2.47G/2.47Gâ€‡[00:27<00:00,â€‡199MB/s]
generation_config.json:â€‡100%
â€‡185/185â€‡[00:00<00:00,â€‡21.0kB/s]
âœ… Model loaded successfully!
   GPU Memory Allocated: 1.55 GB
   GPU Memory Reserved: 2.11 GB

ðŸŽ¯ Setting up LoRA configuration...

ðŸ“Š Trainable Parameters:
trainable params: 5,636,096 || all params: 1,241,450,496 || trainable%: 0.4540

ðŸ“Š Preparing dataset...
   Tokenizing training data...
Tokenizingâ€‡train:â€‡100%
â€‡48/48â€‡[00:00<00:00,â€‡594.68â€‡examples/s]
   Tokenizing validation data...
Tokenizingâ€‡validation:â€‡100%
â€‡12/12â€‡[00:00<00:00,â€‡581.95â€‡examples/s]
âœ… Training samples: 48
âœ… Validation samples: 12

ðŸš€ Starting QLoRA training...
   Device: cuda
   Batch size: 2
   Gradient accumulation: 4
   Effective batch size: 8
   Epochs: 3

â³ Training in progress...
   (This may take 5-10 minutes on T4 GPU)
 [18/18 02:20, Epoch 3/3]
Epoch	Training Loss	Validation Loss
1	3.489300	1.969825
2	1.875700	1.519313
3	1.457200	1.433776

âœ… Training completed successfully!

ðŸ’¾ Saving model...
âœ… Model saved to: ./llama-3.2-qlora-sentiment

======================================================================
ðŸ§ª TESTING FINE-TUNED MODEL
======================================================================

ðŸ” Predictions:
----------------------------------------------------------------------
âœ… Text: This is incredible! Best thing ever!...
   Expected: POSITIVE | Predicted: POSITIVE

âœ… Text: Very disappointed with the quality....
   Expected: NEGATIVE | Predicted: NEGATIVE

âœ… Text: It's okay, nothing special....
   Expected: NEUTRAL | Predicted: NEUTRAL

âœ… Text: Absolutely love this product!...
   Expected: POSITIVE | Predicted: POSITIVE

âœ… Text: Terrible, complete waste of money....
   Expected: NEGATIVE | Predicted: NEGATIVE

âŒ Text: Average quality, does the job....
   Expected: NEUTRAL | Predicted: UNKNOWN

âœ… Text: Outstanding! Highly recommend!...
   Expected: POSITIVE | Predicted: POSITIVE

âœ… Text: Poor quality, not satisfied....
   Expected: NEGATIVE | Predicted: NEGATIVE

âœ… Text: Decent product, nothing special....
   Expected: NEUTRAL | Predicted: NEUTRAL

âœ… Text: Perfect! Exactly what I wanted!...
   Expected: POSITIVE | Predicted: POSITIVE

======================================================================
ðŸŽ¯ FINAL ACCURACY: 9/10 = 90.0%
======================================================================

ðŸ’¬ Want to test interactively? (y/n): y

Interactive Testing Mode (type 'quit' to exit)

Enter text: satisfied product, but i have seen some issues
ðŸŽ­ Predicted Sentiment: NEUTRAL

Enter text: product is up to the mark
ðŸŽ­ Predicted Sentiment: NEUTRAL

Enter text: product is superb
ðŸŽ­ Predicted Sentiment: POSITIVE

Enter text: very bad not useful at all
ðŸŽ­ Predicted Sentiment: NEGATIVE

Enter text: quit

ðŸ‘‹ Goodbye!